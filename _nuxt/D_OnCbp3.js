import{GoogleSignInButton as N}from"./CQcoeLL2.js";import{n as E,o as i,c as u,d as k,b as $,u as s,a as e,t as b,p as D,r as y,z as q,C as z,B as _,D as w,s as T,v as A,F as h,y as f,E as O,G,_ as H}from"./gD-45rxH.js";import{u as K}from"./DNdshR_d.js";import{u as M}from"./DuI0jeSX.js";import{H as R}from"./CB678u4y.js";import"./BXcYWNav.js";const U=E({__name:"googleOauth",props:{access_token:{type:String}},setup(S){const v=S,m=r=>{const{credential:p}=r;console.log("Access Token",p),v.access_token=p},c=()=>{console.error("Login failed")};return(r,p)=>(i(),u("div",null,[p[0]||(p[0]=k("Google Oauth")),$(s(N),{onSuccess:m,onError:c}),e("div",null,b(r.user),1)]))}}),j={class:"popup"},J=E({__name:"Popup",props:{data:{type:String}},setup(S){const v=S;return(m,c)=>(i(),u("div",j,[k(b(v.data),1),c[1]||(c[1]=e("br",null,null,-1)),e("button",{type:"button",onClick:c[0]||(c[0]=r=>m.$emit("closePopup"))},"close")]))}}),Q=["value"],W={class:"display-table"},X=["onUpdate:modelValue"],Y=["onClick"],Z=["onClick"],ee={key:0,class:"error"},te={key:1},ne=["value"],oe={key:2},le=["value","placeholder"],se=E({__name:"fahrtenbucheintrag",async setup(S){let v,m;const c=M();[v,m]=D(()=>c.loadStakeholder()),await v,m();const r=K();[v,m]=D(()=>r.loadBussiData()),await v,m();let p=y(!1),B=y("you should not see this!");const P=()=>p.value=!1,d=y("Fahrt"),I=new Date().toISOString().slice(0,16),g=y(r.bookings[r.bookings.length-1]),o=y(new R((r.bookings.length+1).toString(),I,"",g.value.km,"","asdc","asd","gefahren: 0 km,...","asdfads","adsfas","adas","","0")),n=q({digits:new Array(6).fill(0).map((l,t)=>+g.value.km[t]),value:()=>+n.digits.join(""),kmDriven:()=>n.value()-+g.value.km,range:950,toFar:()=>n.value()-+g.value.km>n.range,withinRange:()=>n.value()-+g.value.km<n.range,inc:l=>n.set(l,n.digits[l]+1),dec:l=>n.set(l,n.digits[l]-1),change:l=>{o.value.description="gefahren: "+n.kmDriven()+" km,...",console.log("change",l)},set:(l,t)=>{t==10?(n.digits[l]=0,n.set(l-1,n.digits[l-1]+1)):t==-1?(n.digits[l]=9,n.set(l-1,n.digits[l-1]-1)):n.digits[l]=+t,n.value()<+g.value.km&&(n.digits=new Array(6).fill(0).map((L,F)=>+g.value.km[F]))}});+o.value.km-+g.value.km;const V=(l,t)=>t.value==="Fahrt"?+l.kmSinceLastEntry<1?{ok:!1,result:+l.kmSinceLastEntry+" km gefahren. Bitte km angeben"}:l.account==="not selected"||l.account===""?{ok:!1,result:"Konto: "+l.account+". bitte Konto angeben"}:{ok:n.withinRange(),result:"km not within range"}:d.value==="Tanken"?{ok:n.withinRange(),result:"km not within range"}:{ok:!1,result:" not yet implemented"},x=async()=>{o.value.date=o.value.date.toString(),o.value.km=o.value.km.toString(),o.value.kmSinceLastEntry=n.kmDriven().toString(),o.value.liters="90",o.value.consumption=(100*+o.value.liters/n.kmDriven()).toString(),o.value.fuelPriceInEuro=o.value.fuelPriceInEuro.toString(),o.value.amount=o.value.amount.toString(),o.value.description=o.value.description.toString(),o.value.key=o.value.key.toString(),o.value.rowNr="42",console.log("onSubmit",o.value);const l=V(o.value,d);l.ok?await r.createBooking(o.value):(B.value=l.result,p.value=!0)};return(l,t)=>{const L=U,F=J;return i(),u("form",{class:"disable-dbl-tap-zoom",onSubmit:O(x,["prevent"])},[$(L,{access_token:l.access_token},null,8,["access_token"]),e("div",null,"access_token: "+b(l.access_token),1),s(p)?(i(),z(F,{key:0,data:s(B),onClosePopup:P},null,8,["data"])):_("",!0),e("div",null,"Fahrtenbucheintrag # "+b(s(r).bookings.length),1),e("button",{class:w({hilight:s(d)=="Fahrt"}),onClick:t[0]||(t[0]=a=>d.value="Fahrt")},"Fahrt",2),e("button",{class:w({hilight:s(d)=="Tanken"}),onClick:t[1]||(t[1]=a=>d.value="Tanken")},"Tanken",2),e("button",{class:w({hilight:s(d)=="Sonstiges"}),onClick:t[2]||(t[2]=a=>d.value="Sonstiges")},"Sonstiges",2),t[11]||(t[11]=e("br",null,null,-1)),e("input",{type:"datetime-local",name:"date",value:s(o).date,required:""},null,8,Q),e("div",null,[T(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>s(o).account=a)},[t[4]||(t[4]=e("option",{disabled:"",value:""},"Bitte Konto auswählen",-1)),(i(!0),u(h,null,f(s(c).stakeholder,a=>(i(),u("option",null,b(a.Name),1))),256))],512),[[A,s(o).account]]),t[5]||(t[5]=e("div",null,null,-1)),e("div",W,[e("div",{class:w(["tacho",s(n).toFar()?"error":""])},[(i(),u(h,null,f([0,1,2,3,4,5],a=>e("div",null,[T(e("input",{class:"km",type:"text","onUpdate:modelValue":C=>s(n).digits[a]=C,readonly:""},null,8,X),[[G,s(n).digits[a]]])])),64))],2),e("div",null,[(i(),u(h,null,f([0,1,2],a=>e("div")),64)),(i(),u(h,null,f([3,4,5],a=>e("div",null,[e("button",{class:"km",type:"button",onClick:C=>{s(n).inc(a),s(n).change(a)}},"+",8,Y)])),64))]),e("div",null,[(i(),u(h,null,f([0,1,2],a=>e("div")),64)),(i(),u(h,null,f([3,4,5],a=>e("div",null,[e("button",{class:"km",type:"button",onClick:C=>s(n).dec(a)},"-",8,Z)])),64))])])]),e("div",null,[s(n).toFar()?(i(),u("span",ee,"Ist das nicht ein bisschen viel? Tanken Eintragung vergessen?")):_("",!0)]),s(d)==="Tanken"?(i(),u("div",te,[e("div",null,[t[6]||(t[6]=k("Liter getankt")),e("input",{type:"text",name:"liters",placeholder:"liters",value:s(o).liters,required:""},null,8,ne)]),t[7]||(t[7]=e("div",null,[k("Verbrauch"),e("input",{type:"text",name:"consumption",value:"9.5",placeholder:"consumption"})],-1)),t[8]||(t[8]=e("div",null,[k("€ pro Liter"),e("input",{type:"text",name:"fuelPriceInEuro",placeholder:"fuelPriceInEuro",required:""})],-1)),t[9]||(t[9]=e("div",null,[k("km gefahren seit letzter Tankfüllung"),e("input",{type:"text",name:"kmSinceLastFuelFill",placeholder:"kmSinceLastFuelFill"})],-1))])):_("",!0),s(d)!="Fahrt"?(i(),u("div",oe,t[10]||(t[10]=[e("div",null,[k("€ Betrag"),e("input",{type:"text",name:"amount",placeholder:"amount",required:""})],-1),e("div",null,[k("Schlüssel"),e("input",{type:"text",name:"key",placeholder:"key"})],-1)]))):_("",!0),e("div",null,[e("input",{type:"text",name:"kmSinceLastEntry",value:s(o).description,placeholder:s(o).description},null,8,le)]),t[12]||(t[12]=e("div",null,[e("button",{type:"submit"},"ins Fahrtenbuch eintragen")],-1))],32)}}}),pe=H(se,[["__scopeId","data-v-74c7e86e"]]);export{pe as default};
