import{Z as te,P as ne,G as se,aa as oe,a5 as ie,av as re,I as le,ab as r,al as l,aw as u,aB as c,L as y,aC as _,aD as g,aE as b,aF as ue,C as ae,aA as D,aG as E,aH as ce,aI as de}from"./app.config.886a5076.js";import{v as fe,w as me,b as F,a as pe}from"./entry.556ab2a9.js";import{l as m}from"./papaparse.min.23b9f094.js";import"./_commonjsHelpers.725317a4.js";const C=f=>(ce("data-v-ca5c4a61"),f=f(),de(),f),he={key:0},ye=C(()=>u("br",null,null,-1)),_e={key:0},ge=C(()=>u("br",null,null,-1)),ve=["disabled"],ke=["disabled","onClick"],be=C(()=>u("br",null,null,-1)),Ce={key:1},Se=C(()=>u("br",null,null,-1)),Ae=["onClick"],we={key:0,class:"isAntiFilter"},Te={key:1,class:"isFilter"},xe=["innerHTML"],Ne={id:"mytable"},Re=["onClick"],Ee={key:0},Fe=C(()=>u("br",null,null,-1)),Le={key:1},Me={key:2},Oe=["onClick"],Be=["onClick","onContextmenu","onMouseover"],Ie=["href","innerHTML"],Pe=["innerHTML"],$e=["innerHTML"],De={style:{"text-align":"right"}},He={key:0},Ue={key:1},Je=te({__name:"Table",props:{konto:{type:String},selectedBookingsToRender:{type:Array},showSum:Boolean},setup(f){const w=f,S=500,s=ne({filters:[],currentRow:{},aggregate:[],rows:w.selectedBookingsToRender}),v=w.selectedBookingsToRender;let L=0,T=se(!0);const M=[];let p="";const O=S;let h=0;const x=oe(),B=ie(),H={},U=[];re(()=>{s.filters=[],x.query.filters=""}),le(s.filters,()=>m("some changed",s.filters));const I=function(){return Math.round(v.length/S)},A=function(o){s.rows=w.selectedBookingsToRender.filter((n,e)=>e>=(o-1)*S&&e<o*S),h=o},J=function(){s.rows=v,h=-1},j=function(o){const n=document.getElementById(o),e=document.createRange();e.selectNode(n);const t=window.getSelection();t.removeAllRanges(),t.addRange(e),document.execCommand("copy"),m("selected: ",o)},q=function(){L<5&&(document.getElementById("popup").style.display="block")},V=function(o){L=o},G=function(o){s.currentRow=o},z=function(o){return JSON.stringify(o,void 0,2).replace(/\n/g,"<br>").replace(/[ ]/g,"&nbsp;")},W=function(o,n){if(m("Table.aggregateby: ",n),s.aggregate.includes(n)){s.aggregate.splice(s.aggregate.indexOf(n),1),s.rows=JSON.parse(M.pop());return}M.push(JSON.stringify(s.rows)),s.aggregate.push(n);const e=[];o.forEach(function(t,i){let a=null;for(const d in e)e[d][n]===t[n]&&(a=d);a!=null?(n!=="Amount"&&n!=="Netto"&&(e[a].Amount+=t.Amount,e[a].Netto+=t.Netto),n!=="CostCenter"&&(e[a].CostCenter+="<br>"+t.CostCenter),e[a].Text+="<br>"+t.Amount+" "+t.Text):e.push(t)}),s.rows=e},k=function(){return s.rows===void 0?[]:s.rows.length===0?[]:Object.keys(s.rows[0]).filter(o=>!"Net FileCreated Steuer Year Month".includes(o))},Y=function(o){return o.toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},Z=o=>+o.replace("€","").replace(".","").replace(",",".").trim(),Q=function(n){let e=0;return s.rows.forEach(function(t){e+=+t[n]}),Math.round(100*e)/100},X=function(n){let e=0;return s.rows===void 0||(s.rows.forEach(function(i){i[n]!==void 0&&(e+=Z(i[n]))}),e=Math.round(1e3*e)/1e3,isNaN(e))?"":e.toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},P=function(){const n=p,e={title:"",value:"",isAnti:!1};e.title="pattern",e.value=n,e.isAnti=n.charAt(0)==="!",e.value=e.isAnti?n.substr(1):n,N(e.title,e.value,e.isAnti),p=null},N=function(n,e,t){m("Table.setfilter: ",n,e);const i={title:n,value:e,isAnti:t},a=s.filters.findIndex(R=>R.title===n&&R.value===e&&R.isAnti===t);a===-1?s.filters.push(i):s.filters[a]=i;const d=Object.assign({},x.query);d.filters=JSON.stringify(s.filters),d.filters=B.replace({query:d}),s.rows=v,A(h),s.rows=$(s.rows,s.filters),m("Table.setfilter: ",s.filters)},K=function(n){m("Table.deleteFiler: ",n,s.filters);const e=s.filters.indexOf(n);m(" ...",e),e>-1&&s.filters.splice(e,1);const t=Object.assign({},x.query);t.filters=JSON.stringify(s.filters),t.filters=B.replace({query:t}),s.rows=v,A(h),s.rows=$(s.rows,s.filters)},$=function(o,n){return o.filter(function(e){let t=!0;return n.forEach(function(i){if(i.title==="pattern"){let a="";for(const d in e)a+=e[d]?e[d].toString().toLowerCase():"";a.includes(i.value.toLowerCase())&&i.isAnti&&(t=!1),a.includes(i.value.toLowerCase())||(t=!1)}else i.isAnti?t=t&&e[i.title]!==i.value:i.isAnti||(t=t&&e[i.title]===i.value)}),t})},ee=function(n,e){const t=e||e||"#";T=!T,T?n.sort((i,a)=>i[t]>a[t]):n.sort((i,a)=>i[t]<a[t])};return A(1),(o,n)=>(r(),l("div",null,[k().length>0||U.length>0?(r(),l("div",he,[u("div",null,[u("b",null,c(f.konto)+": "+c(s.rows.length)+" Einträge",1),ye,I()>1?(r(),l("div",_e,[ge,u("span",null,[u("button",{onClick:n[0]||(n[0]=e=>J()),disabled:y(h)==-1},"show all "+c(y(v).length)+" entries",9,ve)]),u("span",null,[(r(!0),l(_,null,g(I(),(e,t)=>(r(),l("button",{disabled:e==y(h),onClick:i=>A(e)},c((e-1)*y(O)+1)+".."+c(e*y(O)),9,ke))),256))])])):b("",!0),be,ue(u("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>ae(p)?p.value=e:p=e),placeholder:"<enter> new filter",onKeyup:n[2]||(n[2]=me(e=>P(),["enter"]))},null,544),[[fe,y(p)]]),u("input",{type:"submit",value:"set filter",onClick:n[3]||(n[3]=e=>P())}),s.filters[0]?(r(),l("span",Ce,[Se,D("filters:")])):b("",!0),(r(!0),l(_,null,g(s.filters,e=>(r(),l("span",{class:"filter",onClick:t=>K(e)},[e.isAnti==!0?(r(),l("span",we,c(e.title)+": "+c(e.value),1)):(r(),l("span",Te,c(e.title)+": "+c(e.value),1))],8,Ae))),256))]),u("div",{id:"popup",innerHTML:z(s.currentRow)},null,8,xe),u("table",Ne,[u("thead",null,[(r(!0),l(_,null,g(k(),(e,t)=>(r(),l("th",null,[u("div",{onClick:F(i=>ee(s.rows,e),["exact"])},[D(c(e),1),t===k().length-1?(r(),l("span",Ee,[u("input",{class:"right",type:"submit",value:"⧉copy",onClick:n[4]||(n[4]=i=>j("mytable"))})])):b("",!0),Fe,"kmSinceLastEntry Amount haben soll".indexOf(e)>-1?(r(),l("span",Le,c(Q(e)),1)):(r(),l("span",Me," "))],8,Re),(r(),l("button",{key:0,onClick:i=>W(s.rows,e),class:E({active:s.aggregate.indexOf(e)>-1})},"<==>",10,Oe))]))),256))]),u("tbody",null,[(r(!0),l(_,null,g(s.rows,e=>(r(),l("tr",null,[(r(!0),l(_,null,g(k(),(t,i)=>(r(),l("td",{onClick:F(a=>N(t,e[t],!1),["left"]),onContextmenu:F(a=>N(t,e[t],!0),["right"]),onMouseover:a=>(G(e),V(i),q()),onmouseout:"document.getElementById('popup').style.display = 'none'",class:E({hilight:e.Name=="7 ErgebnisNachSteuern",underaccountrow:e.Type=="Unterkonto",greylight:e.Name&&e.Name.includes("Steuer:")})},[u("div",null,[t=="Name"?(r(),l("span",{key:0,class:E({underaccountcell:e.Type=="Unterkonto"})},[u("a",{href:"?report=account&id="+encodeURIComponent(e.Account_Link),innerHTML:e[t].toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},null,8,Ie)],2)):"Revenue Netto Advances Internals Sales Project Commission Taxes Saldo Costs Saldo Amount Balance AnteilAusFaktura AnteilAusFairshares KMDarlehen Aktiva Passiva Rest Salesprv ".indexOf(t)>-1?(r(),l("span",{key:1,style:{"text-align":"right"},innerHTML:Y(e[t])},null,8,Pe)):(r(),l("span",{key:2,innerHTML:e[t]},null,8,$e))])],42,Be))),256))]))),256))]),u("tfoot",null,[u("tr",null,[H!="Account_Link"?(r(!0),l(_,{key:0},g(k(),e=>(r(),l("th",De,[f.showSum&&"Netto Saldo Amount Psoll Phaben".indexOf(e)>-1?(r(),l("span",He,c(X(e)),1)):(r(),l("span",Ue," "))]))),256)):b("",!0)])])])])):b("",!0)]))}}),ze=pe(Je,[["__scopeId","data-v-ca5c4a61"]]);export{ze as default};
