import{n as X,z as Z,g as P,r as K,N as ee,O as te,A as ne,o as r,c as i,a,d as D,t as c,u as k,F as h,y as g,B as S,s as se,G as oe,x as re,P as ie,E,D as b,_ as le}from"./gD-45rxH.js";import{l as v}from"./BXcYWNav.js";const ue={key:0},ae={key:0},ce=["disabled"],de=["disabled","onClick"],fe={key:1},me=["onClick"],pe={key:0,class:"isAntiFilter"},ye={key:1,class:"isFilter"},ke=["onClick"],he={key:0},ge={key:1},ve=["onClick"],Ce=["onClick","onContextmenu","onMouseover"],_e=["href","innerHTML"],Ae=["innerHTML"],Se=["innerHTML"],be={style:{"text-align":"right"}},Te={key:0},we={key:1},T=500,xe=X({__name:"Table",props:{konto:{type:String},selectedBookingsToRender:{type:Array},showSum:Boolean},setup(w){const C=w,n=Z({filters:[],currentRow:{},aggregate:[],rows:C.selectedBookingsToRender});n.rows=C.selectedBookingsToRender,P(()=>C.selectedBookingsToRender,()=>{n.rows=C.selectedBookingsToRender??[]});const d=C.selectedBookingsToRender;let x=K(!0);const O=[];let p="";const L=T;let f=0;const y=ee();te();const $={},q=[];ne(()=>{n.filters=[],y.query.filters=""}),P(n.filters,()=>v("some changed",n.filters));const M=function(){return d?Math.round(d.length/T):0},_=function(l){n.rows=d?d.filter((t,e)=>e>=(l-1)*T&&e<l*T):[],f=l},U=function(){n.rows=d??[],f=-1},H=function(l){},I=function(l){n.currentRow=l},j=function(l,t){if(v("Table.aggregateby: ",t),n.aggregate.includes(t)){n.aggregate.splice(n.aggregate.indexOf(t),1),n.rows=JSON.parse(O.pop());return}O.push(JSON.stringify(n.rows)),n.aggregate.push(t);const e=[];l.forEach(function(s,o){let u=null;for(const m in e)e[m][t]===s[t]&&(u=m);u!=null?(t!=="Amount"&&t!=="Netto"&&(e[+u].Amount+=s.Amount,e[+u].Netto+=s.Netto),t!=="CostCenter"&&(e[+u].CostCenter+="<br>"+s.CostCenter),e[+u].Text+="<br>"+s.Amount+" "+s.Text):e.push(s)}),n.rows=e},A=(l,t="Net FileCreated Steuer Year Month")=>n.rows===void 0||n.rows.length===0?[]:Object.keys(n.rows[0]).filter(e=>!t.includes(e)),J=function(l){return l.toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},V=l=>+l.replace("€","").replace(".","").replace(",",".").trim(),z=function(t){var s;let e=((s=n.rows)==null?void 0:s.reduce((o,u)=>o+ +u[t],0))||0;return Math.round(100*e)/100},G=function(t){let e=0;return n.rows===void 0||(n.rows.forEach(function(o){o[t]!==void 0&&(e+=V(o[t]))}),e=Math.round(1e3*e)/1e3,isNaN(e))?"":e.toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},B=function(){const t=p,e={title:"",value:"",isAnti:!1};e.title="pattern",e.value=t,e.isAnti=t.charAt(0)==="!",e.value=e.isAnti?t.substr(1):t,N(e.title,e.value,e.isAnti),p=""},Q=function(){n.filters=y.query&&y.query.filters?JSON.parse(decodeURIComponent(y.query.filters)):[],n.rows=d??[],_(f),n.rows=R(n.rows,n.filters)},N=function(t,e,s){v("Table.setfilter: ",t,e);const o={title:t,value:e,isAnti:s},u=n.filters.findIndex(F=>F.title===t&&F.value===e&&F.isAnti===s);u===-1?n.filters.push(o):n.filters[u]=o;const m=Object.assign({},y.query);m.filters=JSON.stringify(n.filters),n.rows=d??[],_(f),n.rows=R(n.rows,n.filters),v("Table.setfilter: ",n.filters)},W=function(t){v("Table.deleteFiler: ",t,n.filters);const e=n.filters.indexOf(t);v(" ...",e),e>-1&&n.filters.splice(e,1);const s=Object.assign({},y.query);s.filters=JSON.stringify(n.filters),n.rows=d??[],_(f),n.rows=R(n.rows,n.filters)},R=function(l,t){return l.filter(function(e){let s=!0;return t.forEach(function(o){if(o.title==="pattern"){let u="";for(const m in e)u+=e[m]?e[m].toString().toLowerCase():"";u.includes(o.value.toLowerCase())&&o.isAnti&&(s=!1),u.includes(o.value.toLowerCase())||(s=!1)}else o.isAnti?s=s&&e[o.title]!==o.value:o.isAnti||(s=s&&e[o.title]===o.value)}),s})},Y=function(t,e){const s=e||e||"#";x.value=!x.value,x?t.sort((o,u)=>o[s]>u[s]):t.sort((o,u)=>o[s]<u[s])};return _(1),Q(),(l,t)=>(r(),i("div",null,[A().length>0||q.length>0?(r(),i("div",ue,[a("div",null,[D(c(w.konto)+": "+c(n.rows.length)+" Einträge",1),t[6]||(t[6]=a("br",null,null,-1)),M()>1?(r(),i("div",ae,[t[4]||(t[4]=a("br",null,null,-1)),a("span",null,[a("button",{onClick:t[0]||(t[0]=e=>U()),disabled:k(f)==-1},"show all "+c(k(d).length)+" entries",9,ce)]),a("span",null,[(r(!0),i(h,null,g(M(),(e,s)=>(r(),i("button",{disabled:e==k(f),onClick:o=>_(e)},c((e-1)*k(L)+1)+".."+c(e*k(L)),9,de))),256))])])):S("",!0),t[7]||(t[7]=a("br",null,null,-1)),se(a("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>re(p)?p.value=e:p=e),placeholder:"enter new filter",onKeyup:t[2]||(t[2]=ie(e=>B(),["enter"]))},null,544),[[oe,k(p)]]),a("input",{type:"submit",value:"set filter",onClick:t[3]||(t[3]=e=>B())}),n.filters[0]?(r(),i("span",fe,t[5]||(t[5]=[a("span",null,"filters:",-1)]))):S("",!0),(r(!0),i(h,null,g(n.filters,e=>(r(),i("span",{class:"filter",onClick:s=>W(e)},[e.isAnti==!0?(r(),i("span",pe,c(e.title)+": "+c(e.value),1)):(r(),i("span",ye,c(e.title)+": "+c(e.value),1))],8,me))),256))]),a("table",null,[a("thead",null,[a("tr",null,[(r(!0),i(h,null,g(A(),(e,s)=>(r(),i("th",null,[a("div",{onClick:E(o=>Y(n.rows,s),["exact"])},[D(c(e),1),t[8]||(t[8]=a("br",null,null,-1)),"kmSinceLastEntry Amount haben soll".indexOf(e)>-1?(r(),i("span",he,c(z(s)),1)):(r(),i("span",ge," "))],8,ke),(r(),i("button",{key:0,onClick:o=>j(n.rows,e),class:b({active:n.aggregate.indexOf(e)>-1})},"<==> ",10,ve))]))),256))])]),a("tbody",null,[(r(!0),i(h,null,g(n.rows,e=>(r(),i("tr",null,[(r(!0),i(h,null,g(A(),(s,o)=>(r(),i("td",{onClick:E(u=>N(s,e[s],!1),["left"]),onContextmenu:E(u=>N(s,e[s],!0),["right"]),onMouseover:u=>(I(e),H()),class:b({hilight:e.Name=="7 ErgebnisNachSteuern",underaccountrow:e.Type=="Unterkonto",greylight:e.Name&&e.Name.includes("Steuer:")})},[a("div",{class:b({nowrap:"date amount".indexOf(s)>-1})},[s=="Name"?(r(),i("span",{key:0,class:b({underaccountcell:e.Type=="Unterkonto"})},[a("a",{href:"?report=account&id="+encodeURIComponent(e.Account_Link),innerHTML:e[s].toLocaleString("de-DE",{minimumFractionDigits:2,style:"currency",currency:"EUR"})},null,8,_e)],2)):"Revenue Netto Advances Internals Sales Project Commission Taxes Saldo Costs Saldo Amount Balance AnteilAusFaktura AnteilAusFairshares KMDarlehen Aktiva Passiva Rest Salesprv ".indexOf(s)>-1?(r(),i("span",{key:1,style:{"text-align":"right"},innerHTML:J(e[s])},null,8,Ae)):(r(),i("span",{key:2,innerHTML:e[s]},null,8,Se))],2)],42,Ce))),256))]))),256)),a("tfoot",null,[a("tr",null,[$!="Account_Link"?(r(!0),i(h,{key:0},g(A(),e=>(r(),i("th",be,[w.showSum&&"Netto Saldo Amount Psoll Phaben".indexOf(e)>-1?(r(),i("span",Te,c(G(e)),1)):(r(),i("span",we," "))]))),256)):S("",!0)])])])])])):S("",!0)]))}}),Fe=le(xe,[["__scopeId","data-v-ccc498f3"]]);export{Fe as _};
