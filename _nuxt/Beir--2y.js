import{GoogleSignInButton as N}from"./CgK9KkFG.js";import{n as E,o as i,c as u,d as g,b as $,u as a,a as e,t as S,p as D,r as f,z as q,C as z,B as y,D as b,s as T,v as A,F as k,y as h,E as O,G,_ as H}from"./CX2W2PHd.js";import{u as K}from"./wkpgy-CZ.js";import{u as M}from"./D61gXyfo.js";import{H as R}from"./CB678u4y.js";import"./BXcYWNav.js";const U=E({__name:"googleOauth",setup(_){const v=d=>{const{credential:r}=d;console.log("Access Token",r)},c=()=>{console.error("Login failed")};return(d,r)=>(i(),u("div",null,[r[0]||(r[0]=g("Google Oauth")),$(a(N),{onSuccess:v,onError:c}),e("div",null,S(d.user),1)]))}}),j={class:"popup"},J=E({__name:"Popup",props:{data:{type:String}},setup(_){const v=_;return(c,d)=>(i(),u("div",j,[g(S(v.data),1),d[1]||(d[1]=e("br",null,null,-1)),e("button",{type:"button",onClick:d[0]||(d[0]=r=>c.$emit("closePopup"))},"close")]))}}),Q=["value"],W={class:"display-table"},X=["onUpdate:modelValue"],Y=["onClick"],Z=["onClick"],ee={key:0,class:"error"},te={key:1},ne=["value"],le={key:2},oe=["value","placeholder"],ae=E({__name:"fahrtenbucheintrag",async setup(_){let v,c;const d=M();[v,c]=D(()=>d.loadStakeholder()),await v,c();const r=K();[v,c]=D(()=>r.loadBussiData()),await v,c();let w=f(!1),B=f("you should not see this!");const P=()=>w.value=!1,p=f("Fahrt"),x=new Date().toISOString().slice(0,16),m=f(r.bookings[r.bookings.length-1]),l=f(new R((r.bookings.length+1).toString(),x,"",m.value.km,"","asdc","asd","gefahren: 0 km,...","asdfads","adsfas","adas","","0")),n=q({digits:new Array(6).fill(0).map((o,t)=>+m.value.km[t]),value:()=>+n.digits.join(""),kmDriven:()=>n.value()-+m.value.km,range:950,toFar:()=>n.value()-+m.value.km>n.range,withinRange:()=>n.value()-+m.value.km<n.range,inc:o=>n.set(o,n.digits[o]+1),dec:o=>n.set(o,n.digits[o]-1),change:o=>{l.value.description="gefahren: "+n.kmDriven()+" km,...",console.log("change",o)},set:(o,t)=>{t==10?(n.digits[o]=0,n.set(o-1,n.digits[o-1]+1)):t==-1?(n.digits[o]=9,n.set(o-1,n.digits[o-1]-1)):n.digits[o]=+t,n.value()<+m.value.km&&(n.digits=new Array(6).fill(0).map((L,F)=>+m.value.km[F]))}});+l.value.km-+m.value.km;const I=(o,t)=>t.value==="Fahrt"?+o.kmSinceLastEntry<1?{ok:!1,result:+o.kmSinceLastEntry+" km gefahren. Bitte km angeben"}:o.account==="not selected"||o.account===""?{ok:!1,result:"Konto: "+o.account+". bitte Konto angeben"}:{ok:n.withinRange(),result:"km not within range"}:p.value==="Tanken"?{ok:n.withinRange(),result:"km not within range"}:{ok:!1,result:" not yet implemented"},V=async()=>{l.value.date=l.value.date.toString(),l.value.km=l.value.km.toString(),l.value.kmSinceLastEntry=n.kmDriven().toString(),l.value.liters="90",l.value.consumption=(100*+l.value.liters/n.kmDriven()).toString(),l.value.fuelPriceInEuro=l.value.fuelPriceInEuro.toString(),l.value.amount=l.value.amount.toString(),l.value.description=l.value.description.toString(),l.value.key=l.value.key.toString(),l.value.rowNr="42",console.log("onSubmit",l.value);const o=I(l.value,p);o.ok?await r.createBooking(l.value):(B.value=o.result,w.value=!0)};return(o,t)=>{const L=U,F=J;return i(),u("form",{class:"disable-dbl-tap-zoom",onSubmit:O(V,["prevent"])},[$(L),a(w)?(i(),z(F,{key:0,data:a(B),onClosePopup:P},null,8,["data"])):y("",!0),e("div",null,"Fahrtenbucheintrag # "+S(a(r).bookings.length),1),e("button",{class:b({hilight:a(p)=="Fahrt"}),onClick:t[0]||(t[0]=s=>p.value="Fahrt")},"Fahrt",2),e("button",{class:b({hilight:a(p)=="Tanken"}),onClick:t[1]||(t[1]=s=>p.value="Tanken")},"Tanken",2),e("button",{class:b({hilight:a(p)=="Sonstiges"}),onClick:t[2]||(t[2]=s=>p.value="Sonstiges")},"Sonstiges",2),t[11]||(t[11]=e("br",null,null,-1)),e("input",{type:"datetime-local",name:"date",value:a(l).date,required:""},null,8,Q),e("div",null,[T(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a(l).account=s)},[t[4]||(t[4]=e("option",{disabled:"",value:""},"Bitte Konto auswählen",-1)),(i(!0),u(k,null,h(a(d).stakeholder,s=>(i(),u("option",null,S(s.Name),1))),256))],512),[[A,a(l).account]]),t[5]||(t[5]=e("div",null,null,-1)),e("div",W,[e("div",{class:b(["tacho",a(n).toFar()?"error":""])},[(i(),u(k,null,h([0,1,2,3,4,5],s=>e("div",null,[T(e("input",{class:"km",type:"text","onUpdate:modelValue":C=>a(n).digits[s]=C,readonly:""},null,8,X),[[G,a(n).digits[s]]])])),64))],2),e("div",null,[(i(),u(k,null,h([0,1,2],s=>e("div")),64)),(i(),u(k,null,h([3,4,5],s=>e("div",null,[e("button",{class:"km",type:"button",onClick:C=>{a(n).inc(s),a(n).change(s)}},"+",8,Y)])),64))]),e("div",null,[(i(),u(k,null,h([0,1,2],s=>e("div")),64)),(i(),u(k,null,h([3,4,5],s=>e("div",null,[e("button",{class:"km",type:"button",onClick:C=>a(n).dec(s)},"-",8,Z)])),64))])])]),e("div",null,[a(n).toFar()?(i(),u("span",ee,"Ist das nicht ein bisschen viel? Tanken Eintragung vergessen?")):y("",!0)]),a(p)==="Tanken"?(i(),u("div",te,[e("div",null,[t[6]||(t[6]=g("Liter getankt")),e("input",{type:"text",name:"liters",placeholder:"liters",value:a(l).liters,required:""},null,8,ne)]),t[7]||(t[7]=e("div",null,[g("Verbrauch"),e("input",{type:"text",name:"consumption",value:"9.5",placeholder:"consumption"})],-1)),t[8]||(t[8]=e("div",null,[g("€ pro Liter"),e("input",{type:"text",name:"fuelPriceInEuro",placeholder:"fuelPriceInEuro",required:""})],-1)),t[9]||(t[9]=e("div",null,[g("km gefahren seit letzter Tankfüllung"),e("input",{type:"text",name:"kmSinceLastFuelFill",placeholder:"kmSinceLastFuelFill"})],-1))])):y("",!0),a(p)!="Fahrt"?(i(),u("div",le,t[10]||(t[10]=[e("div",null,[g("€ Betrag"),e("input",{type:"text",name:"amount",placeholder:"amount",required:""})],-1),e("div",null,[g("Schlüssel"),e("input",{type:"text",name:"key",placeholder:"key"})],-1)]))):y("",!0),e("div",null,[e("input",{type:"text",name:"kmSinceLastEntry",value:a(l).description,placeholder:a(l).description},null,8,oe)]),t[12]||(t[12]=e("div",null,[e("button",{type:"submit"},"ins Fahrtenbuch eintragen")],-1))],32)}}}),ve=H(ae,[["__scopeId","data-v-9984113d"]]);export{ve as default};
